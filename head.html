<meta name="viewport"
	content="width=device-width, initial-scale=1"/>
<script src="/scripts/aem.js"
	type="module"></script>
<script src="/scripts/scripts.js"
	type="module"></script>
<link rel="stylesheet"
	href="/styles/stylecompiled.css"/>
<script type="module"
	src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule
	src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
<!--Adyen-->
<script src="https://checkoutshopper-test.cdn.adyen.com/checkoutshopper/sdk/6.13.1/adyen.js"
	integrity="sha384-RxGQ2speO8mIr2OdCCtePyAvtV1Px+IabbiDa7f3EcYsU5vKOpVXV80/x21lAB4R"
	crossorigin="anonymous"></script>
<link rel="stylesheet"
	href="https://checkoutshopper-test.cdn.adyen.com/checkoutshopper/sdk/6.13.1/adyen.css"
	integrity="sha384-Uc2+7uMS+7KgxjNMPhpVZquar2b655d1RaUPWe/mJMO94euXqphe5aEzlj70wNS4"
	crossorigin="anonymous">
<link rel="stylesheet"
	href="/styles/override-adyen.css"/>

<!--DataLayer-->
<script type="text/javascript">
	// Funzione per ottenere i valori del dataLayer client-side secondo le specifiche fornite
	function getDataLayerValues() {
		// Ottieni informazioni sulla pagina corrente
		const currentUrl = new URL(window.location.href);

		// Determina la categoria della pagina
		let pageCategory = "content"; // valore predefinito
		const pathname = currentUrl.pathname;

		if (pathname === "/" || pathname === "/index.html") {
			pageCategory = "home";
		} else if (pathname.includes("/download") || pathname.match(/\.(pdf|zip|exe|dmg|apk)$/i)) {
			pageCategory = "download";
		}

		// Tentativo di rilevamento del paese dell'utente
		let userCountry = "en"; // valore predefinito
		// Cerca il paese in html lang, cookie o custom data attribute
		if (document.documentElement.lang && document.documentElement.lang.includes('-')) {
			userCountry = document.documentElement.lang.split('-')[1].toUpperCase();
		} else if (document.querySelector('meta[name="country"]')) {
			userCountry = document.querySelector('meta[name="country"]').content.toUpperCase();
		}

		// Determina l'ambiente
		let environment = "preprod"; // valore predefinito modificato a preprod
		// Usa prod SOLO se l'hostname Ã¨ esattamente mscfoundation.org
		if (currentUrl.hostname === "mscfoundation.org") {
			environment = "prod";
		} else if (currentUrl.hostname.includes("dev") || currentUrl.hostname.includes("localhost")) {
			environment = "dev";
		}

		// Determina la lingua
		let language = "en"; // valore predefinito
		if (document.documentElement.lang) {
			// Estrai solo la prima parte del codice lingua (es. "it-IT" diventa "it")
			language = document.documentElement.lang.split('-')[0].toLowerCase();
		} else if (document.querySelector('meta[name="language"]')) {
			language = document.querySelector('meta[name="language"]').content.toLowerCase();
		}

		return {
			p_data: "pageview", // valore predefinito per l'evento
			p_category: pageCategory, // home, content, download
			p_country: userCountry, // ISO A-2 code del paese dell'utente
			p_env: environment, // dev, preprod, prod
			p_language: language, // ISO 639-1 language code
			p_location: window.location.href, // URL completo con fragment
			p_path: window.location.pathname // percorso del documento
		};
	}

	// Inizializza il dataLayer
	window.dataLayer = window.dataLayer || [];

	// Ottieni i valori e inseriscili nel dataLayer
	const datalayerValues = getDataLayerValues();
	dataLayer.push({
		event: "p_data",
		p_category: datalayerValues.p_category,
		p_country: datalayerValues.p_country,
		p_env: datalayerValues.p_env,
		p_language: datalayerValues.p_language,
		p_location: datalayerValues.p_location,
		p_path: datalayerValues.p_path
	});
</script>
<!-- End DataLayer -->

<!-- Didomi  -->
<script type="text/javascript">(function(){(function(e){var r=document.createElement("link");r.rel="preconnect";r.as="script";var t=document.createElement("link");t.rel="dns-prefetch";t.as="script";var n=document.createElement("script");n.id="spcloader";n.type="text/javascript";n["async"]=true;n.charset="utf-8";var o="https://sdk.privacy-center.org/"+e+"/loader.js?target="+document.location.hostname;if(window.didomiConfig&&window.didomiConfig.user){var i=window.didomiConfig.user;var a=i.country;var c=i.region;if(a){o=o+"&country="+a;if(c){o=o+"&region="+c}}}r.href="https://sdk.privacy-center.org/";t.href="https://sdk.privacy-center.org/";n.src=o;var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(r,d);d.parentNode.insertBefore(t,d);d.parentNode.insertBefore(n,d)})("749b85dc-f97b-45a3-95ca-d0586bd5cbff")})();</script>
<!-- End Didomi  -->
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
		'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NBZZS7QL');</script>
<!-- End Google Tag Manager -->



